{
  "hash": "055464d63079b2f21da60fd500133147",
  "result": {
    "markdown": "---\ntitle: \"Cyclistic Customer Analysis\"\nsubtitle: \"Google Data Analytics Certificate Capstone\"\ndate: today\nimage: images/josh-mccausland-8TfeD3J4VtQ-thumb.png\nformat:\n  html:\n    highlight-style: breezedark\n    df-print: kable\n    code-fold: true\n    fig-responsive: true\nabstract-title: \"Summary\"\nabstract: \"An analysis of historical Divvy Bikes ride data to identify differences in user cohort behaviour.\"\nparams:\n  start_date: \"September 2021\"\n  end_date: \"August 2022\"\n  zip_dir: \"data/raw\"\neditor:\n  markdown:\n    wrap: sentence\n---\n\n\n::: column-body\n![Image: [Josh McCausland](https://unsplash.com/@joshmccausland?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)](images/josh-mccausland-8TfeD3J4VtQ-thumb.png)\n:::\n\n## Background\n\nIn 2016 Cyclistic launched a bike-sharing sharing offering which has grown to a fleet of 6000 geotracked bicycles and network of more than 1000 stations across Chicago.\n\nAnalysis by Cyclistic's finance team has determined that riders who purchase annual memberships are more profitable than casual riders.\n\nHead of marketing, Lily Moreno, has set a goal of designing marketing strategies aimed at converting casual riders to members.\nThe intial step is to better understand how casual users and members differ.\n\nThis information will provide a basis for members of the marketing analytics team to investigate why casual riders might purchase a membership, and how digital media could influence marketing strategy.\n\nThe executive team, which is detail oriented, will decide whether the proposed marketing strategies are approved.\n\n## Defining the business task\n\nThe scope of this analysis is limited to the first step, and investigates the question:\n\n> How do annual members and casual riders use Cyclistic bikes differently?\n\nUnpacking this question highlights a number of areas that may provide useful insights.\n\n#### What influence does have on user behaviour?\n\nMembers and casual riders access the Cyclistic network under different pricing structures. How much influence does this have on behaviour such as ride duration?\n\n#### When do different user cohorts ride?\n\nWhich days, and times are popular for the different cohorts?\nWhat identifiable differences or commonality in behaviours can be seen?\n\n#### Does weather influence rider behaviour?\n\nAre the types and number of rides related to day-to-day variations in weather or broader seasonal patterns?\nDo members and casual riders differ in this regard?\n\n#### Where do different user cohorts ride?\n\nRiders commuting to work are likely to use docking stations in business districts during the week. Recreational riders may prefer parks and areas along the shoreline or cafe precincts.\n\nIs there a relationship between the type of bike and where users ride?\n\n\n## Analysis\n\n\n::: {.cell}\n\n:::\n\n#### Ride duration\n\n::: {.cell}\n\n```{.r .cell-code}\nbasic <- bike_rides %>%\n  group_by(\n    user_bike,\n    month\n  ) %>%\n  summarise(\n    rides = n(),\n    duration = median(as.numeric(ride_time, units = \"minutes\"))\n  )\n```\n:::\n\n::: {.cell fig.asp='0.7'}\n\n```{.r .cell-code}\nbasic %>%\n  ggplot(\n    aes(\n      month, duration,\n      group = user_bike,\n      colour = user_bike\n    )\n  ) +\n  geom_line() +\n  scale_x_date(\n    breaks = scales::breaks_width(\"2 months\"),\n    labels = scales::label_date(\"%b %Y\", tz = \"America/Chicago\")\n  ) +\n  ylim(0, 30.5) +\n  labs(\n    x = NULL,\n    y = \"Median ride duration in minutes\",\n    colour = \"Segment\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![Median ride duration by market segment](cyclistic_files/figure-html/fig-duration-bike-user-1.svg){#fig-duration-bike-user width=672}\n:::\n:::\n\n\n@fig-duration-bike-user shows the median ride time for each month for the five combinations of bicycle and user type. Member rides are consistently shorter than casual rides.\n\n*Casual-Docked* consistently has the longest median ride duration and appears to identify rides taken on a day pass. For this analysis I have assumed that *Casual-Docked* rides are primarily visitor traffic and are unlikely to take up membership. These rides excluded from further analysis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nday_rides <- bike_rides %>%\n  filter(bike_type != \"Docked\") %>%\n  mutate(weekend = if_else(\n    dayw %in% c(\"Sat\", \"Sun\"),\n    \"Weekend\",\n    \"Weekday\"\n  )) %>%\n  group_by(\n    user_bike,\n    yday = floor_date(started_at, \"day\")\n  ) %>%\n  summarise(\n    weekend,\n    n = n(),\n    duration_mins = as.numeric(median(ride_time)) / 60\n  ) %>%\n  distinct()\n\nm <- day_rides %>%\n  group_by(\n    user_bike,\n    weekend\n  ) %>%\n  summarise(\n    mean_duration = mean(duration_mins)\n  )\n```\n:::\n\n::: {.cell fig.asp='1.1'}\n\n```{.r .cell-code}\nday_rides %>%\n  ggplot(\n    aes(\n      duration_mins,\n      colour = weekend,\n      group = weekend,\n      alpha = 0.7\n    )\n  ) +\n  geom_density() +\n  geom_vline(\n    data = m,\n    aes(\n      xintercept = mean_duration,\n      colour = weekend,\n      alpha = 0.8\n    ),\n    linetype = 2\n  ) +\n  facet_grid(\n    rows = vars(user_bike)\n  ) +\n  guides(\n    alpha = \"none\"\n  ) +\n  xlim(5, 25) +\n  labs(\n    x = \"Median daily ride duration\",\n    colour = \"Day Type\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.key = element_blank(),\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![Distribution of median daily ride times](cyclistic_files/figure-html/fig-dist-median-daily-ride-time-1.svg){#fig-dist-median-daily-ride-time width=672}\n:::\n:::\n\n\nThe distribution of ride durations in  @fig-dist-median-daily-ride-time shows a clear bimodal distribution for member ride duration taken on weekdays. This reflects shorter median duration for rides taken between November and April illustrated by @fig-duration-bike-user, compared with the May to October period.\n\nA weaker bimodal distribution is evident in weekend member rides and casual rides.\n\nBoth member and casual groups electric bikes have a shorter ride duration than classic bikes.\n\nCyclistic pricing changed on 10 May 2022.\nThe changes reduced the casual unlock fee from \\$3.30 to \\$1.00 and removed 30 minutes included time for classic bikes and e-bike trips. There is an indication that the median duration for *Casual-Classic* and *Casual-Electric* trips has declined from May 2022 onwards.\n\n#### Seasonal influence\n\nMember and Casual riding patterns appear to be sensitive to seasonal influences.\n\n::: {.cell fig.asp='0.7'}\n\n```{.r .cell-code}\nbasic %>%\n  filter(\n    user_bike != \"Casual-Docked\"\n  ) %>%\n  ggplot(aes(\n    month, rides,\n    group = user_bike,\n    colour = user_bike\n  )) +\n  geom_line() +\n  scale_y_continuous(\n    breaks = scales::breaks_width(50000),\n    labels = scales::label_comma()\n  ) +\n  scale_x_date(\n    breaks = scales::breaks_width(\"2 months\"),\n    labels = scales::label_date(\"%b %Y\", tz = \"America/Chicago\")\n  ) +\n  labs(\n    x = NULL,\n    y = \"Rides per month\",\n    colour = \"Segment\"\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![Rides per month by market segment](cyclistic_files/figure-html/fig-rides-bike-user-1.svg){#fig-rides-bike-user width=672}\n:::\n:::\n\nThe number of rides taken by all cohorts is lowest in January and February, which coincides with the winter season. Peak ride months cover May, June, July, and September with a slight decline during August.\n\n\n::: {.cell fig.asp='1.1'}\n\n```{.r .cell-code}\nbr_season <- bike_rides %>%\n  mutate(\n    season = as.factor(case_when(\n      month(started_at) %in% c(9, 10, 11) ~ \"Autumn\",\n      month(started_at) %in% c(12, 1, 2) ~ \"Winter\",\n      month(started_at) %in% c(3, 4, 5) ~ \"Spring\",\n      month(started_at) %in% c(6, 7, 8) ~ \"Summer\"\n    )),\n    season = fct_relevel(season, c(\"Autumn\", \"Winter\", \"Spring\", \"Summer\"))\n  ) %>%\n  filter(\n    user_bike != \"Casual-Docked\"\n  )\n\nbr_season %>%\n  group_by(\n    user_bike,\n    season,\n    dayw,\n  ) %>%\n  summarise(\n    avg_rides = n() / n_distinct(date(started_at)),\n    .groups = \"drop\"\n  ) %>%\n  ggplot(\n    aes(\n      dayw,\n      avg_rides,\n      group = user_bike,\n      colour = user_bike\n    )\n  ) +\n  geom_line() +\n  labs(\n    x = \"Day of the week\",\n    y = \"Average daily rides\",\n    colour = \"Segment\"\n  ) +\n  facet_grid(rows = vars(season)) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![Seasonal influence on average daily rides](cyclistic_files/figure-html/fig-rides-by-day-week-1.svg){#fig-rides-by-day-week width=672}\n:::\n:::\n\nOne of the notable features of winter is the consistent number of daily rides taken by members despite the cold.\nMembers take consistently more weekday rides in all seasons.\nPeak days for rides on causal plans are weekends - Saturday and Sunday - with a larger of rides taken on Fridays during the summer months.\n\n\n::: {.cell fig.asp='1.1'}\n\n```{.r .cell-code}\nweather <- read_csv(\n  \"data/raw/chicago_climate_data_noaa.csv\",\n  show_col_types = FALSE,\n  name_repair = janitor::make_clean_names\n) %>%\n  filter(station == \"USW00094846\")\n\nrides_temp <- day_rides %>%\n  inner_join(\n    select(\n      .data = weather,\n      date,\n      tavg,\n      tmin,\n      tmax,\n      awnd,\n      prcp\n    ),\n    by = c(\"yday\" = \"date\")\n  )\n\nrides_temp %>%\n  ggplot(aes(tmax, n, group = user_bike)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(color = \"red\", alpha = 0.5) +\n  facet_grid(\n    rows = vars(user_bike),\n    cols = vars(weekend)\n  ) +\n  theme_minimal() +\n  labs(\n    x = \"Maximum Temperature (Degrees C)\",\n    y = \"Rides\"\n  )\n```\n\n::: {.cell-output-display}\n![Influence of maximum temperature on ride](cyclistic_files/figure-html/fig-avg-median-temp-rides-1.svg){#fig-avg-median-temp-rides width=672}\n:::\n:::\n\n\nThe influence of maximum daily temperatures on number of rides across weekdays and weekends shown in @fig-avg-median-temp-rides.\n\nCasual classic bike ride numbers remain low when the maximum temperature is 10°C or below. Casual e-bike rides start increasing when the maximum temperature reaches 0°C. Casual ride numbers appear to decline once the maximum temperature reaches 30 degrees.\n\nWeekday member rides remain at a consistent level right though winter with similar numbers of electric and classic rides taken. Members show a slight preference for E-bikes when the maximum temperature is below 5°C. Weekend member ride numbers are around 25% lower.\n\nPeak ride numbers occur on days when the maximum temperature is between 25 and 35°C. E-bike ride numbers peak at higher maximum temperatures than classic bikes.\n\nThis suggests that E-bikes encourage casual users to ride when maximum temperatures are in the range of 0°C to +15°C and during hot weather.\n\nOverall, members appear to be less influenced by temperature and seasonal variation than casuals. Member rides have a consistent base of around 2000 rides per weekday through winter. Ride numbers begin to steadily increase once the daily maximum temperature reaches 0°C.\n\nCasual riders who are using E-bikes in cold and hot temperatures on weekdays appear to have similar behaviours to members in that they will ride in a broad range of weather conditions. Riders in this segment who ride several times a month may be candidates for membership.\n\n#### Time of day\n\n::: {.cell fig.asp='1.1'}\n\n```{.r .cell-code}\nbr_season %>%\n  mutate(\n    weekend = if_else(\n      dayw %in% c(\"Sat\", \"Sun\"),\n      \"Weekend\",\n      \"Weekday\"\n    )\n  ) %>%\n  group_by(\n    user_bike,\n    weekend,\n    season,\n    hour\n  ) %>%\n  summarise(\n    avg_rides = n() / n_distinct(date(started_at)),\n    .groups = \"drop\"\n  ) %>%\n  ggplot(\n    aes(\n      hour,\n      avg_rides,\n      group = user_bike,\n      colour = user_bike\n    )\n  ) +\n  geom_line() +\n  labs(\n    x = \"Time of day\",\n    y = \"Average ride starts per hour\",\n    colour = \"Segment\"\n  ) +\n  facet_grid(\n    rows = vars(season),\n    cols = vars(weekend)\n  ) +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![Rides by time of day, day and season](cyclistic_files/figure-html/fig-ride-time-season-1.svg){#fig-ride-time-season width=672}\n:::\n:::\n\n\nMember and casual rides show distinct differences between weekday ride times.\n\nMember ride starts show two well defined peaks aligning with morning and afternoon commutes. Casual rides steadily increase across the day peaking at around 5:30pm. All cohorts display a small peak around midday.\n\nWeekend riding patterns show a steady increase with ride starts levelling off around 10.00am then remaining fairly constant until late afternoon. Ride starts then taper off into the evening with a small peak around 8.30pm.\n\n#### Location\n\n\n::: {.cell fig.asp='1'}\n\n```{.r .cell-code}\nstation_season_time <- br_season %>%\n  mutate(\n    weekend = if_else(\n      dayw %in% c(\"Sat\", \"Sun\"),\n      \"Weekend\",\n      \"Weekday\"\n    )\n  ) %>%\n  filter(\n    !is.na(end_station_name),\n    hour == 10\n  ) %>%\n  group_by(\n    longitude_end,\n    latitude_end,\n    weekend,\n    user_bike\n  ) %>%\n  summarise(nm = n()) %>%\n  group_by(weekend, user_bike) %>%\n  slice_max(nm, n = 50)\n\n# ggmap(chi_map) +\n#   geom_point(\n#     data = station_season_time,\n#     aes(\n#       longitude_end,\n#       latitude_end,\n#       colour = user_bike),\n#     alpha = 0.4,\n#     size = .75) +\n#   facet_grid(\n#     rows = vars(weekend),\n#     cols = vars(user_bike)) +\n#   theme_minimal() +\n#   theme(legend.position = \"bottom\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}